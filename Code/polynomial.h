#pragma once
#include "monomial.h"
#include <vector>
#include <set>
#include <algorithm>
namespace Htto
{
	//多项式类
	//请注意，多项式类除法(operator/)是有问题的（算法上的问题）。我花了2个小时尝试解决它，但是我失败了。但我发现了fraction的bug。抱歉精力有限，现在请不要使用.
	//除以一个单项式是没有问题的。我将写一个分式类来处理除法问题。
	class Polynomial
	{
		friend Polynomial operator-(Polynomial  fra);
	public:
		Polynomial() = default;
		Polynomial(std::string str);
		Polynomial(const Polynomial & poly) :data(poly.data) {}
		Polynomial(const Monomial& mono) :data({ mono }) {}
		void simplification();
		std::string ToString()const;
		std::size_t  term_count();
		std::size_t variable_count();
		Fraction max_times();
		void sort();
		bool operator==(const Polynomial )const;
		Polynomial & operator =(const Polynomial &) = default;
		Polynomial operator +(const Polynomial &)const;
		Polynomial operator -(const Polynomial &)const;
		Polynomial operator *(const Polynomial &)const;
		Polynomial operator /(const Polynomial &)const;
		Polynomial& operator +=(const Polynomial &);
		Polynomial& operator -=(const Polynomial &);
		Polynomial& operator *=(const Polynomial &);
		Polynomial& operator /=(const Polynomial &);
		//输入变量找系数
		Fraction find(std::string str);
		Monomial & operator [](size_t sz) { return data[sz]; }
#ifdef CONSOLE_DEBUG
		std::vector<Monomial> debug()
		{
			return data;
		}
#endif
		int convert_to_int() { return (int)data[0].coef; }
		operator int() { return convert_to_int(); }
	private:

		mutable std::vector<Monomial> data;
		void get_rid_of_zero_monomial()const;
		void push_monomial(const std::string & str);
	};
}